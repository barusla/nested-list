(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('.cdx-nested-list{margin:0;padding:0;outline:none;counter-reset:item;list-style:none}.cdx-nested-list__item{line-height:1.6em;display:flex;margin:2px 0}.cdx-nested-list__item [contenteditable]{outline:none}.cdx-nested-list__item-body{flex-grow:2}.cdx-nested-list__item-content,.cdx-nested-list__item-children{flex-basis:100%}.cdx-nested-list__item-content{word-break:break-word;white-space:pre-wrap}.cdx-nested-list__item-children{counter-increment:nested}.cdx-nested-list__item:before{margin-right:5px;white-space:nowrap}.cdx-nested-list--unordered>.cdx-nested-list__item:before{content:"•"}.cdx-nested-list--ordered>.cdx-nested-list__item:before{counter-increment:item;content:counters(item,".") ". "}.cdx-nested-list--alphabet>.cdx-nested-list__item:before{counter-increment:item;content:counters(item,".",lower-alpha) ". "}.cdx-nested-list--numberalpha>.cdx-nested-list__item:before{counter-increment:item;content:counters(item,".") ". "}.cdx-nested-list--alpharoman>.cdx-nested-list__item:before{counter-increment:item;content:counters(item,".",lower-alpha) ". "}.cdx-nested-list__item-children.cdx-nested-list--numberalpha>.cdx-nested-list__item:before{content:counter(item,lower-alpha) ". "}.cdx-nested-list__item-children.cdx-nested-list--alpharoman>.cdx-nested-list__item:before{content:counter(item,lower-roman) ". "}.cdx-nested-list__settings{display:flex}.cdx-nested-list__settings .cdx-settings-button{width:50%}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
(function(o,m){typeof exports=="object"&&typeof module<"u"?module.exports=m():typeof define=="function"&&define.amd?define(m):(o=typeof globalThis<"u"?globalThis:o||self,o.NestedList=m())})(this,function(){"use strict";function o(d,e=null,t={}){const r=document.createElement(d);Array.isArray(e)?r.classList.add(...e):e&&r.classList.add(e);for(const s in t)r[s]=t[s];return r}function m(d){const e=o("div");return e.appendChild(d),e.innerHTML}function u(d){let e;return d.nodeType!==Node.ELEMENT_NODE?e=d.textContent:(e=d.innerHTML,e=e.replaceAll("<br>","")),e.trim().length===0}class c{constructor(){this.savedFakeCaret=void 0}save(){const e=c.range,t=o("span");t.hidden=!0,e.insertNode(t),this.savedFakeCaret=t}restore(){if(!this.savedFakeCaret)return;const e=window.getSelection(),t=new Range;t.setStartAfter(this.savedFakeCaret),t.setEndAfter(this.savedFakeCaret),e.removeAllRanges(),e.addRange(t),setTimeout(()=>{this.savedFakeCaret.remove()},150)}static get range(){const e=window.getSelection();return e&&e.rangeCount?e.getRangeAt(0):null}static extractFragmentFromCaretPositionTillTheEnd(){const e=window.getSelection();if(!e.rangeCount)return;const t=e.getRangeAt(0);let r=t.startContainer;r.nodeType!==Node.ELEMENT_NODE&&(r=r.parentNode);const s=r.closest("[contenteditable]");t.deleteContents();const i=t.cloneRange();return i.selectNodeContents(s),i.setStart(t.endContainer,t.endOffset),i.extractContents()}static focus(e,t=!0){const r=document.createRange(),s=window.getSelection();r.selectNodeContents(e),r.collapse(t),s.removeAllRanges(),s.addRange(r)}static isAtStart(){const e=window.getSelection();if(e.focusOffset>0)return!1;const t=e.focusNode;return c.getHigherLevelSiblings(t,"left").every(i=>u(i))}static getHigherLevelSiblings(e,t="left"){let r=e;const s=[];for(;r.parentNode&&r.parentNode.contentEditable!=="true";)r=r.parentNode;const i=t==="left"?"previousSibling":"nextSibling";for(;r[i];)r=r[i],s.push(r);return s}}const y='<svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -2.145362, -5.690997)" x="3.008" y="18.606">a</text><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -2.111746, -14.212399)" x="3.008" y="18.606">1</text><rect x="10.181" y="6.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="11.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="16.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/></svg>',f='<svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -2.111746, -14.212399)" x="3.008" y="18.606">1</text><rect x="10.181" y="6.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="11.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="16.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/></svg>',w='<svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -2.305134, -16.716721)" x="3.008" y="18.606">a</text><rect x="10.181" y="6.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="11.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="16.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/></svg>',C='<svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="10.181" y="6.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="11.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="16.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="5.2" y="6.1" width="1" height="1" style="fill: rgb(216, 216, 216); stroke: rgb(0, 0, 0);"/><rect x="5.2" y="11.1" width="1" height="1" style="fill: rgb(216, 216, 216); stroke: rgb(0, 0, 0);"/><rect x="5.2" y="16.1" width="1" height="1" style="fill: rgb(216, 216, 216); stroke: rgb(0, 0, 0);"/></svg>',b='<svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -2.305134, -16.716721)" x="3.008" y="18.606">a</text><rect x="10.181" y="6.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="11.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><rect x="10.181" y="16.085" width="11.017" height="1" style="stroke: rgb(0, 0, 0);"/><text style="font-family: Arial, sans-serif; font-size: 7.6px; font-weight: 700; white-space: pre;" transform="matrix(1.481035, 0, 0, 1.350693, -0.461012, -5.181082)" x="3.008" y="18.606">i</text></svg>',v="";class g{static get isReadOnlySupported(){return!0}static get enableLineBreaks(){return!0}static get toolbox(){return{icon:f,title:"List"}}constructor({data:e,config:t,api:r,readOnly:s}){this.nodes={wrapper:null},this.api=r,this.readOnly=s,this.config=t,this.defaultListStyle=this.config.defaultStyle==="ordered"?"ordered":"unordered";const i={style:this.defaultListStyle,items:[]};this.data=e&&Object.keys(e).length?e:i,this.caret=new c}render(){return this.nodes.wrapper=this.makeListWrapper(this.data.style,[this.CSS.baseBlock]),this.data.items.length?this.appendItems(this.data.items,this.nodes.wrapper):this.appendItems([{content:"",items:[]}],this.nodes.wrapper),this.readOnly||this.nodes.wrapper.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.enterPressed(e);break;case"Backspace":this.backspace(e);break;case"Tab":e.shiftKey?this.shiftTab(e):this.addTab(e);break}},!1),this.nodes.wrapper}renderSettings(){return[{name:"unordered",label:this.api.i18n.t("Odrážky"),icon:C},{name:"ordered",label:this.api.i18n.t("Číslovaný"),icon:f},{name:"alphabet",label:this.api.i18n.t("Abecední"),icon:w},{name:"numberalpha",label:this.api.i18n.t("Čísla a písmena"),icon:y},{name:"alpharoman",label:this.api.i18n.t("Písmena a římská č."),icon:b}].map(t=>({name:t.name,icon:t.icon,label:t.label,isActive:this.data.style===t.name,closeOnActivate:!0,onActivate:()=>{this.listStyle=t.name}}))}static get pasteConfig(){return{tags:["OL","UL","LI"]}}onPaste(e){const t=e.detail.data;this.data=this.pasteHandler(t);const r=this.nodes.wrapper;r&&r.parentNode.replaceChild(this.render(),r)}pasteHandler(e){const{tagName:t}=e;let r,s;switch(t){case"OL":r="ordered",s="ol";break;case"UL":case"LI":r="unordered",s="ul"}const i={style:r,items:[]},a=h=>Array.from(h.querySelectorAll(":scope > li")).map(n=>{var S;const l=n.querySelector(`:scope > ${s}`),x=l?a(l):[];return{content:((S=n==null?void 0:n.firstChild)==null?void 0:S.textContent)||"",items:x}});return i.items=a(e),i}appendItems(e,t){e.forEach(r=>{const s=this.createItem(r.content,r.items);t.appendChild(s)})}createItem(e,t=[]){const r=o("li",this.CSS.item),s=o("div",this.CSS.itemBody),i=o("div",this.CSS.itemContent,{innerHTML:e,contentEditable:!this.readOnly});return s.appendChild(i),r.appendChild(s),t&&t.length>0&&this.addChildrenList(r,t),r}save(){const e=t=>Array.from(t.querySelectorAll(`:scope > .${this.CSS.item}`)).map(s=>{const i=s.querySelector(`.${this.CSS.itemChildren}`),a=this.getItemContent(s),h=i?e(i):[];return{content:a,items:h}});return{style:this.data.style,items:e(this.nodes.wrapper)}}addChildrenList(e,t){const r=e.querySelector(`.${this.CSS.itemBody}`),s=this.makeListWrapper(void 0,[this.CSS.itemChildren]);this.appendItems(t,s),r.appendChild(s)}makeListWrapper(e=this.listStyle,t=[]){const r=e==="ordered"?"ol":"ul",s=()=>{let i;switch(e){case"ordered":i=this.CSS.wrapperOrdered;break;case"unordered":i=this.CSS.wrapperUnordered;break;case"numberalpha":i=this.CSS.wrapperNumberAlpha;break;case"alphabet":i=this.CSS.wrapperAlphabet;break;case"alpharoman":i=this.CSS.wrapperAlpharoman}return i};return t.push(s()),o(r,[this.CSS.wrapper,...t])}get CSS(){return{baseBlock:this.api.styles.block,wrapper:"cdx-nested-list",wrapperUnordered:"cdx-nested-list--unordered",wrapperOrdered:"cdx-nested-list--ordered",wrapperAlphabet:"cdx-nested-list--alphabet",wrapperNumberAlpha:"cdx-nested-list--numberalpha",wrapperAlpharoman:"cdx-nested-list--alpharoman",item:"cdx-nested-list__item",itemBody:"cdx-nested-list__item-body",itemContent:"cdx-nested-list__item-content",itemChildren:"cdx-nested-list__item-children",settingsWrapper:"cdx-nested-list__settings",settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive}}get listStyle(){return this.data.style||this.defaultListStyle}set listStyle(e){const t=Array.from(this.nodes.wrapper.querySelectorAll(`.${this.CSS.wrapper}`));t.push(this.nodes.wrapper),t.forEach(r=>{r.classList.toggle(this.CSS.wrapperUnordered,e==="unordered"),r.classList.toggle(this.CSS.wrapperOrdered,e==="ordered"),r.classList.toggle(this.CSS.wrapperAlphabet,e==="alphabet"),r.classList.toggle(this.CSS.wrapperNumberAlpha,e==="numberalpha"),r.classList.toggle(this.CSS.wrapperAlpharoman,e==="alpharoman")}),this.data.style=e}get currentItem(){let e=window.getSelection().anchorNode;return e.nodeType!==Node.ELEMENT_NODE&&(e=e.parentNode),e.closest(`.${this.CSS.item}`)}enterPressed(e){const t=this.currentItem;e.stopPropagation(),e.preventDefault();const r=this.getItemContent(t).trim().length===0,s=t.parentNode===this.nodes.wrapper,i=t.nextElementSibling===null;if(s&&i&&r){this.getOutOfList();return}else if(i&&r){this.unshiftItem();return}const a=c.extractFragmentFromCaretPositionTillTheEnd(),h=m(a),p=t.querySelector(`.${this.CSS.itemChildren}`),n=this.createItem(h,void 0);p&&Array.from(p.querySelectorAll(`.${this.CSS.item}`)).length>0?p.prepend(n):t.after(n),this.focusItem(n)}unshiftItem(){const e=this.currentItem,t=e.parentNode.closest(`.${this.CSS.item}`);if(!t)return;this.caret.save(),t.after(e),this.caret.restore();const r=t.querySelector(`.${this.CSS.itemChildren}`);r.children.length===0&&r.remove()}getItemContent(e){const t=e.querySelector(`.${this.CSS.itemContent}`);return u(t)?"":t.innerHTML}focusItem(e,t=!0){const r=e.querySelector(`.${this.CSS.itemContent}`);c.focus(r,t)}getOutOfList(){this.currentItem.remove(),this.api.blocks.insert(),this.api.caret.setToBlock(this.api.blocks.getCurrentBlockIndex())}backspace(e){if(!c.isAtStart())return;e.preventDefault();const t=this.currentItem,r=t.previousSibling,s=t.parentNode.closest(`.${this.CSS.item}`);if(!r&&!s)return;e.stopPropagation();let i;if(r){const l=r.querySelectorAll(`.${this.CSS.item}`);i=Array.from(l).pop()||r}else i=s;const a=c.extractFragmentFromCaretPositionTillTheEnd(),h=m(a),p=i.querySelector(`.${this.CSS.itemContent}`);c.focus(p,!1),this.caret.save(),p.insertAdjacentHTML("beforeend",h);let n=t.querySelectorAll(`.${this.CSS.itemChildren} > .${this.CSS.item}`);n=Array.from(n),n=n.filter(l=>l.parentNode.closest(`.${this.CSS.item}`)===t),n.reverse().forEach(l=>{r?i.after(l):t.after(l)}),t.remove(),this.caret.restore()}addTab(e){e.stopPropagation(),e.preventDefault();const t=this.currentItem,r=t.previousSibling;if(!r)return;const i=r.querySelector(`.${this.CSS.itemChildren}`);if(this.caret.save(),i)i.appendChild(t);else{const a=this.makeListWrapper(void 0,[this.CSS.itemChildren]),h=r.querySelector(`.${this.CSS.itemBody}`);a.appendChild(t),h.appendChild(a)}this.caret.restore()}shiftTab(e){e.stopPropagation(),e.preventDefault(),this.unshiftItem()}static joinRecursive(e){return e.items.map(t=>`${t.content} ${g.joinRecursive(t)}`).join("")}static get conversionConfig(){return{export:e=>g.joinRecursive(e),import:e=>({items:[{content:e,items:[]}],style:"unordered"})}}}return g});
